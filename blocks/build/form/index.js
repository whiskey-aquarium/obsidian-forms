(()=>{"use strict";var e,o={565:(e,o,t)=>{const a=window.wp.blocks,i=window.wp.apiFetch;var n=t.n(i);const s=window.wp.components,r=window.wp.element,l=window.wp.i18n,d=(window.wp.data,window.wp.blockEditor),c=window.wp.coreData,p=window.ReactJSXRuntime,m=e=>{const{formSettings:o,handleSettingChange:t}=e;return(0,p.jsx)(p.Fragment,{children:o&&Object.entries(o).map((([e,o])=>"select"===o.type?(0,p.jsx)(s.SelectControl,{label:o.label,value:o.value,options:o.options,onChange:o=>t(e,o)},e):"radio"===o.type?(0,p.jsx)(s.RadioControl,{label:o.label,selected:o.value,options:o.options,onChange:o=>t(e,o)},e):"toggle"===o.type?(0,p.jsx)(s.ToggleControl,{label:o.label,checked:o.value,onChange:o=>t(e,o)},e):(0,p.jsx)(s.TextControl,{label:o.label,value:o.value,onChange:o=>t(e,o)},e)))})},b=JSON.parse('{"$schema":"https://schemas.wp.org/trunk/block.json","apiVersion":3,"name":"obsidian-form/form","version":"0.1.0","title":"Obsidian Form","category":"widgets","icon":"feedback","description":"An Obsidian Form block.","supports":{"html":false,"align":true,"color":{"background":true,"text":true},"anchor":true},"attributes":{"anchor":{"type":"string","default":""},"formPostId":{"type":"number","default":0},"formSettings":{"type":"object","default":{"id":{"label":"Form ID","type":"string","value":""},"title":{"label":"Form Title","type":"string","value":""},"className":{"label":"Form Class","type":"string","value":""},"description":{"label":"Form Description","type":"string","value":""},"labelPlacement":{"label":"Field Label Placement","type":"select","value":"top","options":[{"label":"Top","value":"top"},{"label":"Left","value":"left"},{"label":"Bottom","value":"bottom"}]},"descriptionPlacement":{"label":"Field Description Placement","type":"radio","value":"bottom","options":[{"label":"Top","value":"top"},{"label":"Bottom","value":"bottom"}]},"globalHasPlaceholder":{"label":"Fields Have Placeholders","type":"toggle","value":true},"validationPlacement":{"label":"Validation Placement","type":"radio","value":"bottom","options":[{"label":"Top","value":"top"},{"label":"Bottom","value":"bottom"}]},"requiredIndicator":{"label":"Required Indicator","type":"string","value":"*"}}}},"editorScript":"file:./index.js","editorStyle":"file:./index.css","script":"file:./view.js","style":"file:./style-index.css","allowedBlocks":["obsidian-form/field"],"providesContext":{"obsidian-form/formSettings":"formSettings"},"render":"file:./index.php"}');(0,a.registerBlockType)(b.name,{...b,edit:function(e){const{attributes:o,setAttributes:t}=e,{formPostId:a,formSettings:i}=o,[b,u]=(0,r.useState)(!1),[f,h]=(0,r.useState)(""),[v,g]=(0,r.useState)(null),[w,y]=(0,r.useState)([]),[x,_]=(0,r.useState)(!0),[j,C]=(0,r.useState)(!1),[k,P,S]=(0,c.useEntityBlockEditor)("postType","obsidian_form",{id:a||0}),[O,F]=(0,c.useEntityProp)("postType","obsidian_form","title",a||0),B=(0,d.useBlockProps)({className:"obsidian-form__editor obsidian-form__editor--ready"}),T=(0,d.useInnerBlocksProps)({},{value:k,onInput:P,onChange:S,allowedBlocks:["obsidian-form/field"],renderAppender:k?.length?void 0:d.InnerBlocks.ButtonBlockAppender});(0,r.useEffect)((()=>{a||(_(!0),(async()=>{let e=1,o=[],t=1;for(;e<=t;)try{const a=await n()({path:`/wp/v2/obsidian_form?per_page=100&page=${e}`,parse:!1}),i=await a.json();if(!(i.length>0))break;o=o.concat(i),t=parseInt(a.headers.get("X-WP-TotalPages"),10),e++}catch(e){break}return o})().then((e=>{if(0===e.length)C(!0);else{const o=e.map((e=>({label:`${e.title.rendered} (ID: ${e.id})`,value:e.id})));y(o),C(!1)}})).finally((()=>{_(!1)})))}),[a]);return a?(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(d.InspectorControls,{children:(0,p.jsx)(s.PanelBody,{header:"Obsidian Form Settings",children:(0,p.jsx)(m,{formSettings:i,handleSettingChange:(e,o)=>{const a={...i,[e]:{...i[e],value:o}};t({formSettings:a})}})})}),(0,p.jsxs)("form",{...B,children:[(0,p.jsx)(d.RichText,{value:O,onChange:F,placeholder:(0,l.__)("Enter Form Title","obsidian-forms"),tagName:"h2"}),(0,p.jsx)("div",{className:"wp-block-obsidian-form-fields",children:(0,p.jsx)("div",{...T})})]})]}):(0,p.jsx)(s.Placeholder,{icon:"feedback",label:(0,l.__)("Obsidian Form","obsidian-forms"),instructions:j?(0,l.__)("Create a new form to get started!","obsidian-forms"):(0,l.__)("Create a new form or select an existing one.","obsidian-forms"),children:(0,p.jsxs)("div",{className:"obsidian-forms-choice",children:[(0,p.jsxs)("div",{className:"obsidian-forms-choice__form-creator",children:[(0,p.jsx)(s.TextControl,{placeholder:(0,l.__)("New form titleâ€¦","obsidian-forms"),value:f,onChange:h}),(0,p.jsx)(s.Button,{isPrimary:!0,onClick:async()=>{if(f.trim()){const e=await n()({path:"/wp/v2/obsidian_form",method:"POST",data:{title:f,content:'\x3c!-- wp:obsidian-form/field {"isRequired":true} /--\x3e',status:"publish"}});e?.id&&(t({formPostId:e.id}),u(!1))}},disabled:!f.trim(),children:(0,l.__)("Create","obsidian-forms")})]}),!j&&(0,p.jsxs)("div",{className:"obsidian-forms-choice__form-selector",children:[(0,p.jsx)(s.ComboboxControl,{value:v,options:w,onChange:e=>g(e),shouldShowMenuOnFocus:!0,disabled:x}),(0,p.jsxs)("div",{className:"button-group",children:[(0,p.jsx)(s.Button,{isPrimary:!0,onClick:()=>{v&&t({formPostId:v})},disabled:!v||x,children:(0,l.__)("Select","obsidian-forms")}),(0,p.jsx)(s.Button,{className:"is-secondary",onClick:async()=>{if(v)try{const e=await n()({path:`/wp/v2/obsidian_form/${v}`});if(e?.id){console.log("Form to copy:",e);const o=await n()({path:"/wp/v2/obsidian_form",method:"POST",data:{title:`${e.title.rendered} (Copy)`,content:e.raw_content,status:"publish"}});o?.id&&t({formPostId:o.id})}}catch(e){console.error("Error copying form:",e)}},disabled:!v||x,children:(0,l.__)("Copy","obsidian-forms")})]})]})]})})},save:()=>null})}},t={};function a(e){var i=t[e];if(void 0!==i)return i.exports;var n=t[e]={exports:{}};return o[e](n,n.exports,a),n.exports}a.m=o,e=[],a.O=(o,t,i,n)=>{if(!t){var s=1/0;for(c=0;c<e.length;c++){t=e[c][0],i=e[c][1],n=e[c][2];for(var r=!0,l=0;l<t.length;l++)(!1&n||s>=n)&&Object.keys(a.O).every((e=>a.O[e](t[l])))?t.splice(l--,1):(r=!1,n<s&&(s=n));if(r){e.splice(c--,1);var d=i();void 0!==d&&(o=d)}}return o}n=n||0;for(var c=e.length;c>0&&e[c-1][2]>n;c--)e[c]=e[c-1];e[c]=[t,i,n]},a.n=e=>{var o=e&&e.__esModule?()=>e.default:()=>e;return a.d(o,{a:o}),o},a.d=(e,o)=>{for(var t in o)a.o(o,t)&&!a.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:o[t]})},a.o=(e,o)=>Object.prototype.hasOwnProperty.call(e,o),(()=>{var e={884:0,36:0};a.O.j=o=>0===e[o];var o=(o,t)=>{var i,n,s=t[0],r=t[1],l=t[2],d=0;if(s.some((o=>0!==e[o]))){for(i in r)a.o(r,i)&&(a.m[i]=r[i]);if(l)var c=l(a)}for(o&&o(t);d<s.length;d++)n=s[d],a.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return a.O(c)},t=self.webpackChunkobsidian_forms=self.webpackChunkobsidian_forms||[];t.forEach(o.bind(null,0)),t.push=o.bind(null,t.push.bind(t))})();var i=a.O(void 0,[36],(()=>a(565)));i=a.O(i)})();